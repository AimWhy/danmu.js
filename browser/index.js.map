{"version":3,"sources":["webpack://DanmuJs/webpack/bootstrap","webpack://DanmuJs/./src/utils/util.js","webpack://DanmuJs/./node_modules/es5-ext/object/is-value.js","webpack://DanmuJs/./node_modules/type/value/is.js","webpack://DanmuJs/./src/index.js","webpack://DanmuJs/./src/danmu.js","webpack://DanmuJs/./node_modules/event-emitter/index.js","webpack://DanmuJs/./node_modules/d/index.js","webpack://DanmuJs/./node_modules/type/plain-function/is.js","webpack://DanmuJs/./node_modules/type/function/is.js","webpack://DanmuJs/./node_modules/type/prototype/is.js","webpack://DanmuJs/./node_modules/type/object/is.js","webpack://DanmuJs/./node_modules/es5-ext/object/assign/index.js","webpack://DanmuJs/./node_modules/es5-ext/object/assign/is-implemented.js","webpack://DanmuJs/./node_modules/es5-ext/object/assign/shim.js","webpack://DanmuJs/./node_modules/es5-ext/object/keys/index.js","webpack://DanmuJs/./node_modules/es5-ext/object/keys/is-implemented.js","webpack://DanmuJs/./node_modules/es5-ext/object/keys/shim.js","webpack://DanmuJs/./node_modules/es5-ext/function/noop.js","webpack://DanmuJs/./node_modules/es5-ext/object/valid-value.js","webpack://DanmuJs/./node_modules/es5-ext/object/normalize-options.js","webpack://DanmuJs/./node_modules/es5-ext/string/#/contains/index.js","webpack://DanmuJs/./node_modules/es5-ext/string/#/contains/is-implemented.js","webpack://DanmuJs/./node_modules/es5-ext/string/#/contains/shim.js","webpack://DanmuJs/./node_modules/es5-ext/object/valid-callable.js","webpack://DanmuJs/./src/control.js","webpack://DanmuJs/./src/domrecycle.js","webpack://DanmuJs/./src/main.js","webpack://DanmuJs/./src/channel.js","webpack://DanmuJs/./src/bullet.js","webpack://DanmuJs/./src/style/index.scss?2278","webpack://DanmuJs/./src/style/index.scss","webpack://DanmuJs/./node_modules/css-loader/lib/css-base.js","webpack://DanmuJs/./node_modules/style-loader/lib/addStyles.js","webpack://DanmuJs/./node_modules/style-loader/lib/urls.js"],"names":["util","domObj","RecyclableDomList","createDom","el","tpl","attrs","cname","dom","document","createElement","className","innerHTML","Object","keys","forEach","key","item","value","setAttribute","hasClass","classList","Array","prototype","some","call","match","RegExp","addClass","replace","split","add","removeClass","remove","reg","toggleClass","findDom","sel","querySelector","e","startsWith","getElementById","slice","deepCopy","dst","src","typeOf","Node","concat","obj","toString","copyDom","nodeType","back","tagName","attributes","node","name","formatTime","time","s","Math","floor","ms","DanmuJs","options","self","config","overlap","area","start","end","live","comments","direction","hideArr","comment","duration","mode","container","emit","containerStyle","style","player","bulletBtn","Control","main","pause","play","stop","id","txt","opacity","fontSize","like","prior","realTime","data","unshift","readData","dataHandle","push","oldID","newID","containerPos_","getBoundingClientRect","queue","pauseMove","status","startMove","setLikeDom","danmu","mouseControl","pos","zIndex","force","forceDuration","size","setFontSize","top","channel_id","topInit","channel","resize","indexOf","arr","filter","color","index","splice","Main","defaultOff","state","switchBtn","RecyclableDOMList","initDOM","initSize","init","idleList","usingList","_id","_expand","length","firseIdle","shift","idx","textcontent","i","Channel","playedData","timer","retryTimer","retryStatus","interval","on","updateQueue","bind","nums","rdata","bullet","bol","sort","a","b","setTimeout","resetWithCb","reset","channels","containerPos","resized","currentTime","result","list","Bullet","hasAttached","attach","hasAttach","addBullet","detach","noDiscard","r","removeBullet","containerWidth","width","containerHeight","height","containerLeft","left","containerRight","right","bulletResizeTimer","setInterval","resizeing","abs","isFullscreen","isDanmuPause","bookChannelId","test","navigator","userAgent","channelSize","scroll","bottom","operating","bookId","channelWidth","channelHeight","num","occupy","ceil","message","flag","max","j","curBullet","elPos","curBulletPos","curS","curV","curT","newS","newV","newT","bOffset","dataList","nextAddTime","channelId","loop","cb","moveV","use","appendChild","textContent","random","addEventListener","mouseoverFun","event","mouseControlPause","unuse","off","transformOrigin","transform","transition","clearTimeout","removeTimer","willChange","pastDuration","Date","getTime","moveTime","pastS","ratio","nowS","moveMoreS","moveContainerHeight","moveContainerWidth","startTime","hasMove","func","bulletPos","leftDuration","margin","parentNode","parent","removeChild","likeClass","children","outerHTML"],"mappings":"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AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;;AAEpB;AACA,aAAa,2BAA2B;AACxC;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,0BAA0B;;AAE1B;AACA;AACA;AACA;;;;;;;;ACnIa;;AAEb,sBAAsB,mBAAO,CAAC,CAAe;AAC7C,sBAAsB,mBAAO,CAAC,CAAwB;AACtD,sBAAsB,mBAAO,CAAC,EAAuB;AACrD,sBAAsB,mBAAO,CAAC,EAAkC;AAChE,sBAAsB,mBAAO,CAAC,EAA2B;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA,SAAS;AACT;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA,SAAS;AACT;AACA;;;;;;;;AC7Da;;AAEb,iBAAiB,mBAAO,CAAC,CAAgB;;AAEzC,4BAA4B,EAAE;;AAE9B;AACA;AACA;AACA;AACA;;;;;;;;ACVa;;AAEb,kBAAkB,mBAAO,CAAC,EAAiB;;AAE3C;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;;;;;;;;AClBa;;AAEb,eAAe,mBAAO,CAAC,EAAc;;AAErC;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;;;;;;;ACZa;;AAEb,cAAc,mBAAO,CAAC,CAAa;;AAEnC;AACA,qBAAqB;;AAErB;AACA;AACA;AACA;;;;;;;;ACVa;;AAEb,iBAAiB,mBAAO,CAA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AS;;AAErD;AACA;;;;AAIA,eAAe;;AAEf;AACA;;AAEA,aAAa,mBAAO,CAAC,EAAmD;;AAExE;;AAEA,GAAG,KAAU,EAAE,E;;;;;;ACnBf,2BAA2B,mBAAO,CAAC,EAA+C;AAClF;;;AAGA;AACA,cAAc,QAAS,UAAU,gBAAgB,yBAAyB,sBAAsB,iBAAiB,qBAAqB,SAAS,kBAAkB,mBAAmB,cAAc,WAAW,YAAY,oBAAoB,sBAAsB,8BAA8B,sBAAsB,aAAa,eAAe,kBAAkB,kBAAkB,iBAAiB,kCAAkC,kBAAkB,yBAAyB,uBAAuB,WAAW,YAAY,iBAAiB,kBAAkB,cAAc,oBAAoB,yBAAyB,iDAAiD,yCAAyC,uBAAuB,eAAe,gBAAgB,cAAc;;AAE/vB;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mCAAmC,gBAAgB;AACnD,IAAI;AACJ;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA,YAAY,oBAAoB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,oDAAoD,cAAc;;AAElE;AACA;;;;;;;AC3EA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA,cAAc,mBAAO,CAAC,EAAQ;;AAE9B;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,iBAAiB,mBAAmB;AACpC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,iBAAiB,sBAAsB;AACvC;;AAEA;AACA,mBAAmB,2BAA2B;;AAE9C;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,mBAAmB;AACnC;AACA;;AAEA;AACA;;AAEA,iBAAiB,2BAA2B;AAC5C;AACA;;AAEA,QAAQ,uBAAuB;AAC/B;AACA;AACA,GAAG;AACH;;AAEA,iBAAiB,uBAAuB;AACxC;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;;AAEA;AACA;AACA;;AAEA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;AACA,cAAc;;AAEd,kDAAkD,sBAAsB;AACxE;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uDAAuD;AACvD;;AAEA,6BAA6B,mBAAmB;;AAEhD;;AAEA;;AAEA;AACA;;;;;;;;AC1XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,WAAW,EAAE;AACrD,wCAAwC,WAAW,EAAE;;AAErD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,sCAAsC;AACtC,GAAG;AACH;AACA,8DAA8D;AAC9D;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;AACA","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n","import RecyclableDomList from '../domrecycle.js'\n\nlet util = {}\n\nutil.domObj = new RecyclableDomList()\n\nutil.createDom = function (el = 'div', tpl = '', attrs = {}, cname = '') {\n  let dom = document.createElement(el)\n  dom.className = cname\n  dom.innerHTML = tpl\n  Object.keys(attrs).forEach(item => {\n    let key = item\n    let value = attrs[item]\n    if (el === 'video' || el === 'audio') {\n      if (value) {\n        dom.setAttribute(key, value)\n      }\n    } else {\n      dom.setAttribute(key, value)\n    }\n  })\n  return dom\n}\n\nutil.hasClass = function (el, className) {\n  if (el.classList) {\n    return Array.prototype.some.call(el.classList, item => item === className)\n  } else {\n    return !!el.className.match(new RegExp('(\\\\s|^)' + className + '(\\\\s|$)'))\n  }\n}\n\nutil.addClass = function (el, className) {\n  if (el.classList) {\n    className.replace(/(^\\s+|\\s+$)/g, '').split(/\\s+/g).forEach(item => {\n      item && el.classList.add(item)\n    })\n  } else if (!util.hasClass(el, className)) {\n    el.className += ' ' + className\n  }\n}\n\nutil.removeClass = function (el, className) {\n  if (el.classList) {\n    className.split(/\\s+/g).forEach(item => {\n      el.classList.remove(item)\n    })\n  } else if (util.hasClass(el, className)) {\n    className.split(/\\s+/g).forEach(item => {\n      let reg = new RegExp('(\\\\s|^)' + item + '(\\\\s|$)')\n      el.className = el.className.replace(reg, ' ')\n    })\n  }\n}\n\nutil.toggleClass = function (el, className) {\n  className.split(/\\s+/g).forEach(item => {\n    if (util.hasClass(el, item)) {\n      util.removeClass(el, item)\n    } else {\n      util.addClass(el, item)\n    }\n  })\n}\n\nutil.findDom = function (el = document, sel) {\n  let dom\n  // fix querySelector IDs that start with a digit\n  // https://stackoverflow.com/questions/37270787/uncaught-syntaxerror-failed-to-execute-queryselector-on-document\n  try {\n    dom = el.querySelector(sel)\n  } catch (e) {\n    if (sel.startsWith('#')) {\n      dom = el.getElementById(sel.slice(1))\n    }\n  }\n  return dom\n}\n\nutil.deepCopy = function (dst, src) {\n  if (util.typeOf(src) === 'Object' && util.typeOf(dst) === 'Object') {\n    Object.keys(src).forEach(key => {\n      if (util.typeOf(src[key]) === 'Object' && !(src[key] instanceof Node)) {\n        if (!dst[key]) {\n          dst[key] = src[key]\n        } else {\n          util.deepCopy(dst[key], src[key])\n        }\n      } else if (util.typeOf(src[key]) === 'Array') {\n        dst[key] = util.typeOf(dst[key]) === 'Array' ? dst[key].concat(src[key]) : src[key]\n      } else {\n        dst[key] = src[key]\n      }\n    })\n    return dst\n  }\n}\n\nutil.typeOf = function (obj) {\n  return Object.prototype.toString.call(obj).match(/([^\\s.*]+)(?=]$)/g)[0]\n}\n\nutil.copyDom = function (dom) {\n  if (dom && dom.nodeType === 1) {\n    let back = document.createElement(dom.tagName)\n    Array.prototype.forEach.call(dom.attributes, (node) => {\n      back.setAttribute(node.name, node.value)\n    })\n    if (dom.innerHTML) {\n      back.innerHTML = dom.innerHTML\n    }\n    return back\n  } else {\n    return ''\n  }\n}\n\nutil.formatTime = function (time) {\n  let s = Math.floor(time)\n  let ms = time - s\n  return s * 1000 + ms\n}\n\nexport default util\n","\"use strict\";\n\nvar _undefined = require(\"../function/noop\")(); // Support ES3 engines\n\nmodule.exports = function (val) { return val !== _undefined && val !== null; };\n","\"use strict\";\n\n// ES3 safe\nvar _undefined = void 0;\n\nmodule.exports = function (value) { return value !== _undefined && value !== null; };\n","import DanmuJs from './danmu'\nimport './style/index.scss'\nexport default DanmuJs\n","import EventEmitter from 'event-emitter'\nimport Control from './control'\nimport util from './utils/util'\n\nclass DanmuJs {\n  constructor (options) {\n    let self = this\n    self.config = util.deepCopy({\n      overlap: false,\n      area: {\n        start: 0,\n        end: 1\n      },\n      live: false,\n      comments: [],\n      direction: 'r2l'\n    }, options)\n    self.hideArr = []\n    EventEmitter(self)\n    self.config.comments.forEach(comment => {\n      comment.duration = comment.duration ? comment.duration : 5000\n      if(!comment.mode) {\n        comment.mode = 'scroll'\n      }\n    })\n    if(self.config.container && self.config.container.nodeType === 1) {\n      self.container = self.config.container\n    } else {\n      self.emit('error', 'container id can\\'t be empty')\n      return false\n    }\n    if(self.config.containerStyle) {\n      let style = self.config.containerStyle\n      Object.keys(style).forEach(function (key) {\n        self.container.style[key] = style[key]\n      })\n    }\n    self.live = self.config.live\n    self.player = self.config.player\n    self.direction = self.config.direction\n    util.addClass(self.container, 'danmu')\n    self.bulletBtn = new Control(self)\n    self.emit('ready')\n  }\n  \n  start () {\n    this.bulletBtn.main.start()\n  }\n\n  pause () {\n    this.bulletBtn.main.pause()\n  }\n\n  play () {\n    this.bulletBtn.main.play()\n  }\n\n  stop () {\n    this.bulletBtn.main.stop()\n  }\n\n  sendComment (comment) {\n    if(!comment.duration) {\n      comment.duration = 15000\n    }\n    if (comment && comment.id && comment.duration && (comment.el || comment.txt)) {\n      comment.duration = comment.duration ? comment.duration : 5000\n      // console.log(comment.style)\n      if (comment.style) {\n        if (this.opacity && this.opacity !== comment.style.opacity) {\n          comment.style.opacity = this.opacity\n        }\n        if (this.fontSize && this.fontSize !== comment.style.fontSize) {\n          comment.style.fontSize = this.fontSize\n        }\n        if (this.like) {\n          comment.like = comment.like ? comment.like : this.like\n        }\n      }\n      if(comment.prior || comment.realTime) {\n        this.bulletBtn.main.data.unshift(comment)\n        if (comment.realTime) {\n          this.bulletBtn.main.readData()\n          this.bulletBtn.main.dataHandle()\n        }\n      } else {\n        this.bulletBtn.main.data.push(comment)\n      }\n    }\n  }\n\n  setCommentID (oldID, newID) {\n    let containerPos_ = this.container.getBoundingClientRect()\n    if (oldID && newID) {\n      this.bulletBtn.main.data.some(data => {\n        if(data.id === oldID) {\n          data.id = newID\n          return true\n        } else {\n          return false\n        }\n      })\n      this.bulletBtn.main.queue.some(item => {\n        if(item.id === oldID) {\n          item.id = newID\n          item.pauseMove(containerPos_)\n          this.bulletBtn.main.status !== 'paused' && item.startMove(containerPos_)\n          return true\n        } else {\n          return false\n        }\n      })\n    }\n  }\n\n  setCommentDuration (id, duration) {\n    let containerPos_ = this.container.getBoundingClientRect()\n    if (id && duration) {\n      duration = duration ? duration : 5000\n      this.bulletBtn.main.data.some(data => {\n        if(data.id === id) {\n          data.duration = duration\n          return true\n        } else {\n          return false\n        }\n      })\n      this.bulletBtn.main.queue.some(item => {\n        if(item.id === id) {\n          item.duration = duration\n          item.pauseMove(containerPos_)\n          this.bulletBtn.main.status !== 'paused' && item.startMove(containerPos_)\n          return true\n        } else {\n          return false\n        }\n      })\n    }\n  }\n\n  setCommentLike (id, like) {\n    let containerPos_ = this.container.getBoundingClientRect()\n    this.like = like\n    if (id && like) {\n      this.bulletBtn.main.data.some(data => {\n        if(data.id === id) {\n          data.like = like\n          return true\n        } else {\n          return false\n        }\n      })\n      this.bulletBtn.main.queue.some(item => {\n        if(item.id === id) {\n          item.pauseMove(containerPos_)\n          item.setLikeDom(like.el, like.style)\n          if (item.danmu.bulletBtn.main.status !== 'paused') {\n            item.startMove(containerPos_)\n          }\n          return true\n        } else {\n          return false\n        }\n      })\n    }\n  }\n\n  restartComment (id) {\n    this.mouseControl = false\n    let pos = this.container.getBoundingClientRect()\n    if (id) {\n      this.bulletBtn.main.queue.some(item => {\n        if(item.id === id) {\n          if (item.danmu.bulletBtn.main.status !== 'paused') {\n            item.startMove(pos, true)\n          }\n          else {\n            item.status = 'paused'\n          }\n          return true\n        } else {\n          return false\n        }\n      })\n    }\n  }\n\n  freezeComment (id) {\n    this.mouseControl = true\n    let pos = this.container.getBoundingClientRect()\n    if (id) {\n      this.bulletBtn.main.queue.some(item => {\n        if(item.id === id) {\n          item.status = 'forcedPause'\n          item.pauseMove(pos)\n          if (item.el && item.el.style) {\n            item.el.style.zIndex = 10\n          }\n          return true\n        } else {\n          return false\n        }\n      })\n    }\n  }\n\n  removeComment (id) {\n    if (!id) return\n    this.bulletBtn.main.queue.some(item => {\n      if(item.id === id) {\n        item.remove()\n        return true\n      } else {\n        return false\n      }\n    })\n  }\n\n  setAllDuration (mode = 'scroll', duration, force) {\n    let containerPos_ = this.container.getBoundingClientRect()\n    if (duration) {\n      duration = duration ? duration : 5000\n      if (force) {\n        this.bulletBtn.main.forceDuration = duration\n      }\n      this.bulletBtn.main.data.forEach(data => {\n        if(mode === data.mode) {\n          data.duration = duration\n        }\n      })\n      this.bulletBtn.main.queue.forEach(item => {\n        if(mode === item.mode) {\n          item.duration = duration\n          item.pauseMove(containerPos_)\n          if (item.danmu.bulletBtn.main.status !== 'paused') {\n            item.startMove(containerPos_)\n          }\n        }\n      })\n    }\n  }\n\n  setOpacity (opacity) {\n    this.container.style.opacity = opacity\n  }\n  \n  setFontSize (size, fontSize) {\n    this.fontSize = `${size}px`\n    if (size) {\n      this.bulletBtn.main.data.forEach(data => {\n        if (data.style) {\n          data.style.fontSize = this.fontSize\n        }\n      })\n      this.bulletBtn.main.queue.forEach(item => {\n        if (!item.options.style) {\n          item.options.style = {}\n        }\n        \n        item.options.style.fontSize = this.fontSize\n        item.setFontSize(this.fontSize)\n        if (fontSize) {\n          item.top = item.channel_id[0] * fontSize;\n          item.topInit()\n        }\n      })\n    }\n    if (fontSize) {\n      this.config.fontSize = fontSize\n      this.bulletBtn.main.channel.resize(true)\n    }\n  }\n  \n  setArea (area) {\n    this.config.area = area\n    this.bulletBtn.main.channel.resize(true)\n  }\n\n  hide (mode = 'scroll') {\n    if(this.hideArr.indexOf(mode) < 0) {\n      this.hideArr.push(mode)\n    }\n    let arr = this.bulletBtn.main.queue.filter(item => mode === item.mode || (mode === 'color' && item.color))\n    arr.forEach(item => item.remove())\n  }\n\n  show (mode = 'scroll') {\n    let index = this.hideArr.indexOf(mode)\n    if(index > -1) {\n      this.hideArr.splice(index, 1)\n    }\n  }\n\n  setDirection (direction = 'r2l') {\n    this.emit('changeDirection', direction)\n  }\n}\n\nexport default DanmuJs\n","'use strict';\n\nvar d        = require('d')\n  , callable = require('es5-ext/object/valid-callable')\n\n  , apply = Function.prototype.apply, call = Function.prototype.call\n  , create = Object.create, defineProperty = Object.defineProperty\n  , defineProperties = Object.defineProperties\n  , hasOwnProperty = Object.prototype.hasOwnProperty\n  , descriptor = { configurable: true, enumerable: false, writable: true }\n\n  , on, once, off, emit, methods, descriptors, base;\n\non = function (type, listener) {\n\tvar data;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) {\n\t\tdata = descriptor.value = create(null);\n\t\tdefineProperty(this, '__ee__', descriptor);\n\t\tdescriptor.value = null;\n\t} else {\n\t\tdata = this.__ee__;\n\t}\n\tif (!data[type]) data[type] = listener;\n\telse if (typeof data[type] === 'object') data[type].push(listener);\n\telse data[type] = [data[type], listener];\n\n\treturn this;\n};\n\nonce = function (type, listener) {\n\tvar once, self;\n\n\tcallable(listener);\n\tself = this;\n\ton.call(this, type, once = function () {\n\t\toff.call(self, type, once);\n\t\tapply.call(listener, this, arguments);\n\t});\n\n\tonce.__eeOnceListener__ = listener;\n\treturn this;\n};\n\noff = function (type, listener) {\n\tvar data, listeners, candidate, i;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return this;\n\tdata = this.__ee__;\n\tif (!data[type]) return this;\n\tlisteners = data[type];\n\n\tif (typeof listeners === 'object') {\n\t\tfor (i = 0; (candidate = listeners[i]); ++i) {\n\t\t\tif ((candidate === listener) ||\n\t\t\t\t\t(candidate.__eeOnceListener__ === listener)) {\n\t\t\t\tif (listeners.length === 2) data[type] = listeners[i ? 0 : 1];\n\t\t\t\telse listeners.splice(i, 1);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif ((listeners === listener) ||\n\t\t\t\t(listeners.__eeOnceListener__ === listener)) {\n\t\t\tdelete data[type];\n\t\t}\n\t}\n\n\treturn this;\n};\n\nemit = function (type) {\n\tvar i, l, listener, listeners, args;\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return;\n\tlisteners = this.__ee__[type];\n\tif (!listeners) return;\n\n\tif (typeof listeners === 'object') {\n\t\tl = arguments.length;\n\t\targs = new Array(l - 1);\n\t\tfor (i = 1; i < l; ++i) args[i - 1] = arguments[i];\n\n\t\tlisteners = listeners.slice();\n\t\tfor (i = 0; (listener = listeners[i]); ++i) {\n\t\t\tapply.call(listener, this, args);\n\t\t}\n\t} else {\n\t\tswitch (arguments.length) {\n\t\tcase 1:\n\t\t\tcall.call(listeners, this);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tcall.call(listeners, this, arguments[1]);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tcall.call(listeners, this, arguments[1], arguments[2]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tl = arguments.length;\n\t\t\targs = new Array(l - 1);\n\t\t\tfor (i = 1; i < l; ++i) {\n\t\t\t\targs[i - 1] = arguments[i];\n\t\t\t}\n\t\t\tapply.call(listeners, this, args);\n\t\t}\n\t}\n};\n\nmethods = {\n\ton: on,\n\tonce: once,\n\toff: off,\n\temit: emit\n};\n\ndescriptors = {\n\ton: d(on),\n\tonce: d(once),\n\toff: d(off),\n\temit: d(emit)\n};\n\nbase = defineProperties({}, descriptors);\n\nmodule.exports = exports = function (o) {\n\treturn (o == null) ? create(base) : defineProperties(Object(o), descriptors);\n};\nexports.methods = methods;\n","\"use strict\";\n\nvar isValue         = require(\"type/value/is\")\n  , isPlainFunction = require(\"type/plain-function/is\")\n  , assign          = require(\"es5-ext/object/assign\")\n  , normalizeOpts   = require(\"es5-ext/object/normalize-options\")\n  , contains        = require(\"es5-ext/string/#/contains\");\n\nvar d = (module.exports = function (dscr, value/*, options*/) {\n\tvar c, e, w, options, desc;\n\tif (arguments.length < 2 || typeof dscr !== \"string\") {\n\t\toptions = value;\n\t\tvalue = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[2];\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t\tw = contains.call(dscr, \"w\");\n\t} else {\n\t\tc = w = true;\n\t\te = false;\n\t}\n\n\tdesc = { value: value, configurable: c, enumerable: e, writable: w };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n});\n\nd.gs = function (dscr, get, set/*, options*/) {\n\tvar c, e, options, desc;\n\tif (typeof dscr !== \"string\") {\n\t\toptions = set;\n\t\tset = get;\n\t\tget = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[3];\n\t}\n\tif (!isValue(get)) {\n\t\tget = undefined;\n\t} else if (!isPlainFunction(get)) {\n\t\toptions = get;\n\t\tget = set = undefined;\n\t} else if (!isValue(set)) {\n\t\tset = undefined;\n\t} else if (!isPlainFunction(set)) {\n\t\toptions = set;\n\t\tset = undefined;\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t} else {\n\t\tc = true;\n\t\te = false;\n\t}\n\n\tdesc = { get: get, set: set, configurable: c, enumerable: e };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n};\n","\"use strict\";\n\nvar isFunction = require(\"../function/is\");\n\nvar classRe = /^\\s*class[\\s{/}]/, functionToString = Function.prototype.toString;\n\nmodule.exports = function (value) {\n\tif (!isFunction(value)) return false;\n\tif (classRe.test(functionToString.call(value))) return false;\n\treturn true;\n};\n","\"use strict\";\n\nvar isPrototype = require(\"../prototype/is\");\n\nmodule.exports = function (value) {\n\tif (typeof value !== \"function\") return false;\n\n\tif (!hasOwnProperty.call(value, \"length\")) return false;\n\n\ttry {\n\t\tif (typeof value.length !== \"number\") return false;\n\t\tif (typeof value.call !== \"function\") return false;\n\t\tif (typeof value.apply !== \"function\") return false;\n\t} catch (error) {\n\t\treturn false;\n\t}\n\n\treturn !isPrototype(value);\n};\n","\"use strict\";\n\nvar isObject = require(\"../object/is\");\n\nmodule.exports = function (value) {\n\tif (!isObject(value)) return false;\n\ttry {\n\t\tif (!value.constructor) return false;\n\t\treturn value.constructor.prototype === value;\n\t} catch (error) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\nvar isValue = require(\"../value/is\");\n\n// prettier-ignore\nvar possibleTypes = { \"object\": true, \"function\": true, \"undefined\": true /* document.all */ };\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) return false;\n\treturn hasOwnProperty.call(possibleTypes, typeof value);\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.assign : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\tvar assign = Object.assign, obj;\n\tif (typeof assign !== \"function\") return false;\n\tobj = { foo: \"raz\" };\n\tassign(obj, { bar: \"dwa\" }, { trzy: \"trzy\" });\n\treturn obj.foo + obj.bar + obj.trzy === \"razdwatrzy\";\n};\n","\"use strict\";\n\nvar keys  = require(\"../keys\")\n  , value = require(\"../valid-value\")\n  , max   = Math.max;\n\nmodule.exports = function (dest, src/*, …srcn*/) {\n\tvar error, i, length = max(arguments.length, 2), assign;\n\tdest = Object(value(dest));\n\tassign = function (key) {\n\t\ttry {\n\t\t\tdest[key] = src[key];\n\t\t} catch (e) {\n\t\t\tif (!error) error = e;\n\t\t}\n\t};\n\tfor (i = 1; i < length; ++i) {\n\t\tsrc = arguments[i];\n\t\tkeys(src).forEach(assign);\n\t}\n\tif (error !== undefined) throw error;\n\treturn dest;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.keys : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\ttry {\n\t\tObject.keys(\"primitive\");\n\t\treturn true;\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\nvar isValue = require(\"../is-value\");\n\nvar keys = Object.keys;\n\nmodule.exports = function (object) { return keys(isValue(object) ? Object(object) : object); };\n","\"use strict\";\n\n// eslint-disable-next-line no-empty-function\nmodule.exports = function () {};\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) throw new TypeError(\"Cannot use null or undefined\");\n\treturn value;\n};\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nvar forEach = Array.prototype.forEach, create = Object.create;\n\nvar process = function (src, obj) {\n\tvar key;\n\tfor (key in src) obj[key] = src[key];\n};\n\n// eslint-disable-next-line no-unused-vars\nmodule.exports = function (opts1/*, …options*/) {\n\tvar result = create(null);\n\tforEach.call(arguments, function (options) {\n\t\tif (!isValue(options)) return;\n\t\tprocess(Object(options), result);\n\t});\n\treturn result;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? String.prototype.contains : require(\"./shim\");\n","\"use strict\";\n\nvar str = \"razdwatrzy\";\n\nmodule.exports = function () {\n\tif (typeof str.contains !== \"function\") return false;\n\treturn str.contains(\"dwa\") === true && str.contains(\"foo\") === false;\n};\n","\"use strict\";\n\nvar indexOf = String.prototype.indexOf;\n\nmodule.exports = function (searchString/*, position*/) {\n\treturn indexOf.call(this, searchString, arguments[1]) > -1;\n};\n","\"use strict\";\n\nmodule.exports = function (fn) {\n\tif (typeof fn !== \"function\") throw new TypeError(fn + \" is not a function\");\n\treturn fn;\n};\n","import util from './utils/util'\nimport Main from './main'\n\nclass Control {\n  constructor (danmu) {\n    this.danmu = danmu\n    this.main = new Main(danmu)\n    if(!danmu.config.defaultOff) {\n      this.main.start()\n    }\n  }\n\n  createSwitch (state = true) {\n    this.switchBtn = util.createDom('dk-switch', '<span class=\"txt\">弹</span>', {}, `danmu-switch ${state ? 'danmu-switch-active' : ''}`)\n    return this.switchBtn\n  }\n}\n\nexport default Control\n","\nexport default class RecyclableDOMList {\n  constructor(options) {\n    options = {\n      initDOM: () => document.createElement('div'),\n      initSize: 10\n    }\n    this.init(options)\n  }\n\n  init(options) {\n    this.idleList = []\n    this.usingList = []\n    this._id = 0\n    this.options = options\n    this._expand(options.initSize)\n  }\n\n  use() {\n    if (!this.idleList.length) {\n      this._expand(1)\n    }\n    const firseIdle = this.idleList.shift()\n    this.usingList.push(firseIdle)\n    return firseIdle\n  }\n\n  unuse(dom) {\n    const idx = this.usingList.indexOf(dom)\n    if (idx < 0) {\n      return\n    }\n    this.usingList.splice(idx, 1)\n    dom.innerHTML = ''\n    dom.textcontent = ''\n    dom.style = ''\n    this.idleList.push(dom)\n  }\n\n  _expand(size) {\n    for (let i = 0; i < size; i++) {\n      this.idleList.push(this.options.initDOM(this._id++))\n    }\n  }\n}","import Channel from './channel'\nimport Bullet from './bullet'\nimport util from './utils/util'\n\n/**\n * [Main 弹幕主进程]\n * @type {Class}\n */\nclass Main {\n  constructor (danmu) {\n    this.danmu = danmu\n    this.container = danmu.container\n    this.channel = new Channel(danmu)// 弹幕轨道实例\n    this.data = [].concat(danmu.config.comments)\n    this.playedData = []\n    this.queue = []// 等待播放的弹幕队列\n    this.timer = null// 弹幕动画定时器句柄\n    this.retryTimer = null// 弹幕更新重试定时器句柄\n    this.retryStatus = 'normal'\n    this.interval = danmu.config.interval || 2000// 弹幕队列缓存间隔\n    this.status = 'idle'// 当前弹幕正在闲置\n    danmu.on('bullet_remove', this.updateQueue.bind(this))\n    let self = this\n    this.danmu.on('changeDirection', direction => {\n      self.danmu.direction = direction\n    })\n    this.nums = 0\n  }\n  // 在渲染队列中移除已经展示完的弹幕对象\n  updateQueue (rdata) {\n    let self = this\n    self.queue.some((item, index) => {\n      if (item.id === rdata.bullet.id) {\n        self.queue.splice(index, 1)\n        return true\n      } else {\n        return false\n      }\n    })\n  }\n  init (bol, self) {\n    if (!self) {\n      self = this\n    }\n    self.retryStatus = 'normal'\n    self.data.sort((a, b) => a.start - b.start)\n    let dataHandle = function () {\n      self.readData()\n      self.dataHandle()\n      if (self.retryStatus !== 'stop') {\n        setTimeout(function () {\n          dataHandle()\n        }, self.interval - 1000)\n      }\n    }\n    if (!self.retryTimer) {\n      dataHandle()\n    }\n  }\n  // 启动弹幕渲染主进程\n  start () {\n    let self = this\n    this.status = 'playing'\n    this.queue = []\n    this.container.innerHTML = ''\n    this.channel.resetWithCb(self.init, self)\n  }\n  stop () {\n    let self = this\n    this.status = 'closed'\n    self.retryTimer = null\n    self.retryStatus = 'stop'\n    self.channel.reset()\n    this.queue = []\n    self.container.innerHTML = ''\n  }\n  play () {\n    this.status = 'playing'\n    let channels = this.channel.channels\n    let containerPos = this.danmu.container.getBoundingClientRect()\n    if (channels && channels.length > 0) {\n      ['scroll', 'top', 'bottom'].forEach( key => {\n        for (let i = 0; i < channels.length; i++) {\n          channels[i].queue[key].forEach(item => {\n            if(!item.resized) {\n              item.startMove(containerPos)\n              item.resized = true\n            }\n          })\n        }\n        for (let i = 0; i < channels.length; i++) {\n          channels[i].queue[key].forEach(item => {\n            item.resized = false\n          })\n        }\n      })\n    }\n  }\n  pause () {\n    this.status = 'paused'\n    let channels = this.channel.channels\n    let containerPos = this.danmu.container.getBoundingClientRect()\n    if (channels && channels.length > 0) {\n      // ['scroll', 'top', 'bottom'].forEach( key => {\n      //   for (let i = 0; i < channels.length; i++) {\n      //     channels[i].queue[key].forEach(item => {\n      //       item.pauseMove(containerPos)\n      //     })\n      //   }\n      // })\n      this.queue.forEach(item => {\n        item.pauseMove(containerPos)\n      })\n    }\n  }\n  dataHandle () {\n    let self = this\n    if (this.status === 'paused' || this.status === 'closed') {\n      return\n    }\n    if (self.queue.length) {\n      self.queue.forEach(item => {\n        if (item.status === 'waiting' || item.status === 'paused') {\n          // item.status = 'start'\n          item.startMove(self.channel.containerPos)\n        }\n      })\n    }\n  }\n  readData () {\n    let self = this, danmu = this.danmu\n    let currentTime = 0\n    if(danmu.player && danmu.player.currentTime) {\n      currentTime = util.formatTime(danmu.player.currentTime)\n    }\n    let bullet, interval = self.interval, channel = self.channel, result\n    let list\n    if(danmu.player) {\n      list = self.data.filter(item => {\n        if (!item.start && self.danmu.hideArr.indexOf(item.mode) < 0) {\n          if (!item.color || self.danmu.hideArr.indexOf('color') < 0) {\n            item.start = currentTime\n          }\n        }\n        return self.danmu.hideArr.indexOf(item.mode) < 0 && (!item.color || self.danmu.hideArr.indexOf('color') < 0) && item.start - interval <= currentTime && currentTime <= item.start + interval\n      })\n      if(danmu.live) {\n        self.data = self.data.filter(item => {\n          if (!item.start) {\n            item.start = currentTime\n          }\n          return item.start > currentTime - 3 * interval\n        })\n      }\n    } else {\n      list = self.data.splice(0, 1)\n      // self.data = []\n      if(list.length === 0) list = self.playedData.splice(0, 1)\n    }\n\n    if (list.length > 0) {\n      list.forEach(item => {\n        if (self.forceDuration && self.forceDuration != item.duration) {\n          item.duration = self.forceDuration;\n        }\n        bullet = new Bullet(danmu, item)\n        if (!item.hasAttached) {\n          bullet.attach()\n          item.hasAttach = true\n        }\n        result = channel.addBullet(bullet)\n        if (result.result) {\n          self.queue.push(bullet)\n          self.nums++;\n          bullet.topInit()\n        } else {\n          bullet.detach()\n          if(item.noDiscard) {\n            if(item.prior) {\n              self.data.unshift(item)\n            } else {\n              self.data.push(item)\n            }\n          }\n        }\n      })\n    }\n  }\n}\n\nexport default Main\n","/**\n * [Channel 弹幕轨道控制]\n * @type {Class}\n */\nclass Channel {\n  constructor (danmu) {\n    this.danmu = danmu\n    this.reset()\n    let self = this\n    this.danmu.on('bullet_remove', function (r) {\n      self.removeBullet(r.bullet)\n    })\n    this.direction = danmu.direction\n    this.danmu.on('changeDirection', direction => {\n      self.direction = direction\n    })\n\n    this.containerPos = this.danmu.container.getBoundingClientRect()\n    this.containerWidth = this.containerPos.width\n    this.containerHeight = this.containerPos.height\n    this.containerLeft = this.containerPos.left\n    this.containerRight = this.containerPos.right\n    this.danmu.bulletResizeTimer = setInterval(function () {\n      self.containerPos = self.danmu.container.getBoundingClientRect()\n      if (self.resizeing) {\n        return\n      }\n      if (Math.abs(self.containerPos.width - self.containerWidth) >= 2 || Math.abs(self.containerPos.height - self.containerHeight) >= 2 || Math.abs(self.containerPos.left - self.containerLeft) >= 2 || Math.abs(self.containerPos.right - self.containerRight) >= 2) {\n        self.containerWidth = self.containerPos.width\n        self.containerHeight = self.containerPos.height\n        self.containerLeft = self.containerPos.left\n        self.containerRight = self.containerPos.right\n        self.resize(true)\n      }\n    }, 50)\n  }\n  resize (isFullscreen = false) {\n    let container = this.danmu.container\n    let self = this\n    if (self.resizeing) {\n      return\n    }\n    self.resizeing = true\n    setTimeout(function () {\n      let isDanmuPause = self.danmu.bulletBtn.main.status === 'paused'\n      if (self.danmu.bulletBtn.main.data) {\n        self.danmu.bulletBtn.main.data.forEach(item => {\n          if (item.bookChannelId) {\n            delete item['bookChannelId']\n            // console.log('resize导致' + item.id + '号优先弹幕预定取消')\n          }\n        })\n      }\n      // console.log('resize导致所有轨道恢复正常使用')\n      let size = container.getBoundingClientRect()\n      self.width = size.width\n      self.height = size.height\n  \n      if (self.danmu.config.area && self.danmu.config.area.start >= 0 && self.danmu.config.area.end >= self.danmu.config.area.start) {\n        if(self.direction === 'b2t') {\n          self.width = self.width * (self.danmu.config.area.end - self.danmu.config.area.start)\n        } else {\n          self.height = self.height * (self.danmu.config.area.end - self.danmu.config.area.start)\n        }\n      }\n      self.container = container\n      let fontSize = self.danmu.config.fontSize || (/mobile/ig.test(navigator.userAgent) ? 10 : 12)\n      let channelSize\n      if(self.direction === 'b2t') {\n        channelSize = Math.floor(self.width / fontSize)\n      } else {\n        channelSize = Math.floor(self.height / fontSize)\n      }\n      let channels = []\n      for (let i = 0; i < channelSize; i++) {\n        channels[i] = {\n          id: i,\n          queue: {\n            scroll: [],\n            top: [],\n            bottom: []\n          },\n          operating: {\n            scroll: false,\n            top: false,\n            bottom: false\n          },\n          bookId: {}\n        }\n      }\n      if (self.channels && self.channels.length <= channels.length) {\n        for (let i = 0; i < self.channels.length; i++) {\n          channels[i] = {\n            id: i,\n            queue: {\n              scroll: [],\n              top: [],\n              bottom: []\n            },\n            operating: {\n              scroll: false,\n              top: false,\n              bottom: false\n            },\n            bookId: {}\n          };\n          ['scroll', 'top'].forEach(key => {\n            self.channels[i].queue[key].forEach(item => {\n              if (item.el) {\n                channels[i].queue[key].push(item)\n                if(!item.resized) {\n                  item.pauseMove(self.containerPos, isFullscreen)\n                  if (item.danmu.bulletBtn.main.status !== 'paused') {\n                    item.startMove(self.containerPos)\n                  }\n                  item.resized = true\n                }\n              }\n            })\n          })\n          self.channels[i].queue['bottom'].forEach(item => {\n            if (item.el) {\n              channels[i + channels.length - self.channels.length].queue['bottom'].push(item)\n              if(item.channel_id[0] + item.channel_id[1] - 1 === i) {\n                let channel_id = [].concat(item.channel_id)\n                item.channel_id = [channel_id[0] - self.channels.length + channels.length, channel_id[1]]\n                item.top = item.channel_id[0] * fontSize\n                if (self.danmu.config.area && self.danmu.config.area.start) {\n                  item.top += self.containerHeight * self.danmu.config.area.start\n                }\n                item.topInit()\n              }\n              if(!item.resized) {\n                item.pauseMove(self.containerPos, isFullscreen)\n                if (item.danmu.bulletBtn.main.status !== 'paused') {\n                  item.startMove(self.containerPos)\n                }\n                item.resized = true\n              }\n            }\n          })\n        }\n        for (let i = 0; i < channels.length; i++) {\n          ['scroll', 'top', 'bottom'].forEach(key => {\n            channels[i].queue[key].forEach(item => {\n              // console.log('resized 重置:' + item)\n              item.resized = false\n            })\n          })\n        }\n        self.channels = channels\n        if(self.direction === 'b2t') {\n          self.channelWidth = fontSize\n        } else {\n          self.channelHeight = fontSize\n        }\n      } else if (self.channels && self.channels.length > channels.length) {\n        for (let i = 0; i < channels.length; i++) {\n          channels[i] = {\n            id: i,\n            queue: {\n              scroll: [],\n              top: [],\n              bottom: []\n            },\n            operating: {\n              scroll: false,\n              top: false,\n              bottom: false\n            },\n            bookId: {}\n          };\n          ['scroll', 'top', 'bottom'].forEach(key => {\n            if (key === 'top' && i > Math.floor(channels.length / 2)) {\n  \n            } else if (key === 'bottom' && i <= Math.floor(channels.length / 2)) {\n  \n            } else {\n              let num = key === 'bottom' ? i - channels.length + self.channels.length : i\n              self.channels[num].queue[key].forEach((item, index) => {\n                if (item.el) {\n                  channels[i].queue[key].push(item)\n                  if(key === 'bottom') {\n                    if(item.channel_id[0] + item.channel_id[1] - 1 === num) {\n                      let channel_id = [].concat(item.channel_id)\n                      item.channel_id = [channel_id[0] - self.channels.length + channels.length, channel_id[1]]\n                      item.top = item.channel_id[0] * fontSize\n                      if (self.danmu.config.area && self.danmu.config.area.start) {\n                        item.top += self.containerHeight * self.danmu.config.area.start\n                      }\n                      item.topInit()\n                    }\n                  }\n                  item.pauseMove(self.containerPos, isFullscreen)\n                  if (item.danmu.bulletBtn.main.status !== 'paused') {\n                    item.startMove(self.containerPos)\n                  }\n                  if(!item.resized) {\n                    item.resized = true\n                  }\n                }\n                self.channels[num].queue[key].splice(index, 1)\n              })\n            }\n          })\n        }\n        for (let i = channels.length; i < self.channels.length; i++) {\n          ['scroll', 'top', 'bottom'].forEach(key => {\n            self.channels[i].queue[key].forEach(item => {\n              item.pauseMove(self.containerPos)\n              item.remove()\n            })\n          })\n        }\n        for (let i = 0; i < channels.length; i++) {\n          ['scroll', 'top', 'bottom'].forEach(key => {\n            channels[i].queue[key].forEach(item => {\n              // console.log('resized 重置:' + item)\n              item.resized = false\n            })\n          })\n        }\n        self.channels = channels\n        if(self.direction === 'b2t') {\n          self.channelWidth = fontSize\n        } else {\n          self.channelHeight = fontSize\n        }\n      }\n      self.resizeing = false\n    }, 10)\n  }\n  addBullet (bullet) {\n    // if (bullet.prior) {\n      // console.log(bullet.id + '号优先弹幕请求注册')\n    // }\n    let self = this\n    let danmu = this.danmu\n    let channels = this.channels\n    let channelHeight, channelWidth, occupy\n    if(self.direction === 'b2t') {\n      channelWidth = this.channelWidth\n      occupy = Math.ceil(bullet.width / channelWidth)\n    } else {\n      channelHeight = this.channelHeight\n      occupy = Math.ceil(bullet.height / channelHeight)\n    }\n    if (occupy > channels.length) {\n      return {\n        result: false,\n        message: `exceed channels.length, occupy=${occupy},channelsSize=${channels.length}`\n      }\n    } else {\n      let flag = true, channel, pos = -1\n      for (let i = 0, max = channels.length; i < max; i++) {\n        if (channels[i].queue[bullet.mode].some(item => item.id === bullet.id)) {\n          return {\n            result: false,\n            message: `exsited, channelOrder=${i},danmu_id=${bullet.id}`\n          }\n        }\n      }\n      if(bullet.mode === 'scroll') {\n        for (let i = 0, max = channels.length - occupy; i <= max; i++) {\n          flag = true\n          for (let j = i; j < i + occupy; j++) {\n            channel = channels[j]\n            if (channel.operating.scroll) {\n              flag = false\n              break\n            }\n            if ((channel.bookId.scroll || bullet.prior) && (channel.bookId.scroll !== bullet.id)) {\n              flag = false\n              break\n            }\n            channel.operating.scroll = true\n            let curBullet = channel.queue.scroll[0]\n            if (curBullet && (curBullet.elPos || curBullet.el)) {\n              let curBulletPos = curBullet.el ? curBullet.el.getBoundingClientRect() : curBullet.elPos;\n              if(self.direction === 'b2t') {\n                if (curBulletPos.bottom > self.containerPos.bottom) {\n                  flag = false\n                  channel.operating.scroll = false\n                  break\n                }\n              } else {\n                if (curBulletPos.right > self.containerPos.right) {\n                  flag = false\n                  channel.operating.scroll = false\n                  break\n                }\n              }\n\n              // Vcur * t + Scur已走 - Widthcur = Vnew * t\n              // t = (Scur已走 - Widthcur) / (Vnew - Vcur)\n              // Vnew * t < Widthplayer\n              let curS, curV, curT, newS, newV, newT\n              if(self.direction === 'b2t') {\n                curS = curBulletPos.top - self.containerPos.top + curBulletPos.height\n\n                curV = (self.containerPos.height + curBulletPos.height) / curBullet.duration\n                curT = curS / curV\n\n                newS = self.containerPos.height\n                newV = (self.containerPos.height + bullet.height) / bullet.duration\n              } else {\n                curS = curBulletPos.left - self.containerPos.left + curBulletPos.width\n\n                curV = (self.containerPos.width + curBulletPos.width) / curBullet.duration\n                curT = curS / curV\n\n                newS = self.containerPos.width\n                newV = (self.containerPos.width + bullet.width) / bullet.duration\n              }\n              newT = newS / newV\n              if (!danmu.config.bOffset) {\n                danmu.config.bOffset = 0\n              }\n              if (curV < newV && curT + danmu.config.bOffset > newT) {\n                flag = false\n                channel.operating.scroll = false\n                break\n              }\n            }\n            channel.operating.scroll = false\n          }\n          if (flag) {\n            pos = i\n            break\n          }\n        }\n      } else if (bullet.mode === 'top') {\n        for (let i = 0, max = channels.length - occupy; i <= max; i++) {\n          flag = true\n          for (let j = i; j < i + occupy; j++) {\n            if(j > Math.floor(channels.length / 2)) {\n              flag = false\n              break\n            }\n            channel = channels[j]\n            if (channel.operating[bullet.mode]) {\n              flag = false\n              break\n            }\n            if ((channel.bookId[bullet.mode] || bullet.prior) && (channel.bookId[bullet.mode] !== bullet.id)) {\n              flag = false\n              break\n            }\n            channel.operating[bullet.mode] = true\n            if (channel.queue[bullet.mode].length > 0) {\n              flag = false\n              channel.operating[bullet.mode] = false\n              break\n            }\n            channel.operating[bullet.mode] = false\n          }\n          if (flag) {\n            pos = i\n            break\n          }\n        }\n      } else if (bullet.mode === 'bottom') {\n        for (let i = channels.length - occupy; i >= 0; i--) {\n          flag = true\n          for (let j = i; j < i + occupy; j++) {\n            if(j <= Math.floor(channels.length / 2)) {\n              flag = false\n              break\n            }\n            channel = channels[j]\n            if (channel.operating[bullet.mode]) {\n              flag = false\n              break\n            }\n            if ((channel.bookId[bullet.mode] || bullet.prior) && (channel.bookId[bullet.mode] !== bullet.id)) {\n              flag = false\n              break\n            }\n            channel.operating[bullet.mode] = true\n            if (channel.queue[bullet.mode].length > 0) {\n              flag = false\n              channel.operating[bullet.mode] = false\n              break\n            }\n            channel.operating[bullet.mode] = false\n          }\n          if (flag) {\n            pos = i\n            break\n          }\n        }\n      }\n\n      if (pos !== -1) {\n        for (let i = pos, max = pos + occupy; i < max; i++) {\n          channel = channels[i]\n          channel.operating[bullet.mode] = true\n          channel.queue[bullet.mode].unshift(bullet)\n          if (bullet.prior) {\n            delete channel.bookId[bullet.mode]\n            // console.log(i + '号轨道恢复正常使用')\n          }\n          channel.operating[bullet.mode] = false\n        }\n        if (bullet.prior) {\n          // console.log(bullet.id + '号优先弹幕运行完毕')\n          delete bullet['bookChannelId']\n          if(danmu.player) {\n            let dataList = danmu.bulletBtn.main.data\n            dataList.some(function (item) {\n              if (item.id === bullet.id) {\n                delete item['bookChannelId']\n                return true\n              } else {\n                return false\n              }\n            })\n          }\n        }\n        bullet.channel_id = [pos, occupy]\n\n        if(self.direction === 'b2t') {\n          bullet.top = pos * channelWidth\n          if (self.danmu.config.area && self.danmu.config.area.start) {\n            bullet.top += self.containerWidth * self.danmu.config.area.start\n          }\n        } else {\n          bullet.top = pos * channelHeight\n          if (self.danmu.config.area && self.danmu.config.area.start) {\n            bullet.top += self.containerHeight * self.danmu.config.area.start\n          }\n        }\n        return {\n          result: bullet,\n          message: 'success'\n        }\n      } else {\n        if (bullet.prior) {\n          if (!bullet.bookChannelId) {\n            pos = -1\n            for (let i = 0, max = channels.length - occupy; i <= max; i++) {\n              flag = true\n              for (let j = i; j < i + occupy; j++) {\n                if (channels[j].bookId[bullet.mode]) {\n                  flag = false\n                  break\n                }\n              }\n              if (flag) {\n                pos = i\n                break\n              }\n            }\n            if (pos !== -1) {\n              for (let j = pos; j < pos + occupy; j++) {\n                channels[j].bookId[bullet.mode] = bullet.id\n                // console.log(j + '号轨道被' + bullet.id + '号优先弹幕预定')\n              }\n              let nextAddTime = 2\n              if(danmu.player) {\n                let dataList = danmu.bulletBtn.main.data\n                dataList.some(function (item) {\n                  if (item.id === bullet.id) {\n                    // console.log(bullet.id + '号优先弹幕将于' + nextAddTime + '秒后再次请求注册')\n                    item.start += nextAddTime * 1000\n                    item.bookChannelId = [pos, occupy]\n                    // console.log(bullet.id + '号优先弹幕预定了' + pos + '~' + pos + occupy - 1 + '号轨道')\n                    // console.log(`${bullet.id}号优先弹幕预定了${pos}~${pos + occupy - 1}号轨道`)\n                    return true\n                  } else {\n                    return false\n                  }\n                })\n              }\n            }\n          } else {\n            let nextAddTime = 2\n            if(danmu.player) {\n              let dataList = danmu.bulletBtn.main.data\n              dataList.some(function (item) {\n                if (item.id === bullet.id) {\n                  // console.log(bullet.id + '号优先弹幕将于' + nextAddTime + '秒后再次请求注册')\n                  item.start += nextAddTime * 1000\n                  return true\n                } else {\n                  return false\n                }\n              })\n            }\n          }\n        }\n        return {\n          result: false,\n          message: 'no surplus will right'\n        }\n      }\n    }\n  }\n  removeBullet (bullet) {\n    // console.log('removeBullet')\n    let channels = this.channels\n    let channelId = bullet.channel_id\n    let channel\n    for (let i = channelId[0], max = channelId[0] + channelId[1]; i < max; i++) {\n      channel = channels[i]\n      if (channel) {\n        channel.operating[bullet.mode] = true\n        let i = -1\n        channel.queue[bullet.mode].some((item, index) => {\n          if (item.id === bullet.id) {\n            i = index\n            return true\n          } else {\n            return false\n          }\n        })\n        if (i > -1) {\n          channel.queue[bullet.mode].splice(i, 1)\n        }\n        channel.operating[bullet.mode] = false\n      }\n    }\n    if(bullet.options.loop) {\n      this.danmu.bulletBtn.main.playedData.push(bullet.options)\n    }\n  }\n  reset () {\n    let container = this.danmu.container\n    let self = this\n    if (self.channels && self.channels.length > 0) {\n      ['scroll', 'top', 'bottom'].forEach(key => {\n        for (let i = 0; i < self.channels.length; i++) {\n          self.channels[i].queue[key].forEach(item => {\n            item.pauseMove(self.containerPos)\n            item.remove()\n          })\n        }\n      })\n    }\n    setTimeout(function () {\n      let size = container.getBoundingClientRect()\n      self.width = size.width\n      self.height = size.height\n      if (self.danmu.config.area && self.danmu.config.area.start >= 0 && self.danmu.config.area.end >= self.danmu.config.area.start) {\n        if(self.direction === 'b2t') {\n          self.width = self.width * (self.danmu.config.area.end - self.danmu.config.area.start)\n        } else {\n          self.height = self.height * (self.danmu.config.area.end - self.danmu.config.area.start)\n        }\n      }\n      self.container = container\n      let fontSize =self.danmu.config.fontSize || (/mobile/ig.test(navigator.userAgent) ? 10 : 12)\n      let channelSize\n      if(self.direction === 'b2t') {\n        channelSize = Math.floor(self.width / fontSize)\n      } else {\n        channelSize = Math.floor(self.height / fontSize)\n      }\n\n      let channels = []\n      for (let i = 0; i < channelSize; i++) {\n        channels[i] = {\n          id: i,\n          queue: {\n            scroll: [],\n            top: [],\n            bottom: []\n          },\n          operating: {\n            scroll: false,\n            top: false,\n            bottom: false\n          },\n          bookId: {}\n        }\n      }\n      self.channels = channels\n      if(self.direction === 'b2t') {\n        self.channelWidth = fontSize\n      } else {\n        self.channelHeight = fontSize\n      }\n    }, 200)\n  }\n  resetWithCb (cb, main) {\n    let container = this.danmu.container\n    let self = this\n    if (self.channels && self.channels.length > 0) {\n      ['scroll', 'top', 'bottom'].forEach(key => {\n        for (let i = 0; i < self.channels.length; i++) {\n          self.channels[i].queue[key].forEach(item => {\n            item.pauseMove(self.containerPos)\n            item.remove()\n          })\n        }\n      })\n    }\n    let size = container.getBoundingClientRect()\n    self.width = size.width\n    self.height = size.height\n    if (self.danmu.config.area && self.danmu.config.area.start >= 0 && self.danmu.config.area.end >= self.danmu.config.area.start) {\n      if(self.direction === 'b2t') {\n        self.width = self.width * (self.danmu.config.area.end - self.danmu.config.area.start)\n      } else {\n        self.height = self.height * (self.danmu.config.area.end - self.danmu.config.area.start)\n      }\n    }\n    self.container = container\n    let fontSize = self.danmu.config.fontSize || (/mobile/ig.test(navigator.userAgent) ? 10 : 12)\n    let channelSize\n    if(self.direction === 'b2t') {\n      channelSize = Math.floor(self.width / fontSize)\n    } else {\n      channelSize = Math.floor(self.height / fontSize)\n    }\n    let channels = []\n    for (let i = 0; i < channelSize; i++) {\n      channels[i] = {\n        id: i,\n        queue: {\n          scroll: [],\n          top: [],\n          bottom: []\n        },\n        operating: {\n          scroll: false,\n          top: false,\n          bottom: false\n        },\n        bookId: {}\n      }\n    }\n    self.channels = channels\n    self.channelHeight = fontSize\n    if (cb) {\n      cb(true, main)\n    }\n  }\n}\n\nexport default Channel\n","import util from './utils/util'\n\n/**\n * [Bullet 弹幕构造类]\n * @type {Class}\n */\nclass Bullet {\n  constructor (danmu, options) {\n    this.danmu = danmu\n    this.options = options\n    this.duration = options.duration\n    this.moveV = options.moveV\n    this.id = options.id\n    this.container = danmu.container\n    this.start = options.start\n    this.prior = options.prior\n    this.color = options.color\n    this.bookChannelId = options.bookChannelId\n    this.direction = danmu.direction\n    let self = this\n    this.danmu.on('changeDirection', direction => {\n      self.direction = direction\n    })\n    let el\n    this.domObj = util.domObj\n    if(options.el && options.el.nodeType === 1) {\n      el = this.domObj.use()\n      el.appendChild(util.copyDom(options.el))\n      // el = util.copyDom(options.el)\n    } else {\n      el = this.domObj.use()\n      // el = document.createElement('div')\n      el.textContent = options.txt\n      if(options.style) {\n        let style = options.style\n        Object.keys(style).forEach(function (key) {\n          el.style[key] = style[key]\n        })\n      }\n    }\n    if(options.mode === 'top' || options.mode === 'bottom') {\n      this.mode = options.mode\n    } else {\n      this.mode = 'scroll'\n    }\n    this.el = el\n    if (options.like && options.like.el) {\n      this.setLikeDom(options.like.el, options.like.style)\n    }\n    this.status = 'waiting'// waiting,start,end\n    let containerPos = this.container.getBoundingClientRect()\n    var random = Math.floor(Math.random() * ((containerPos.width / 10) > 100 ? 200 : containerPos.width / 10));\n    if (options.realTime) {\n      random = 0\n    }\n    this.el.style.left = containerPos.width + random + 'px';\n  }\n  attach () {\n    let self = this\n    self.container.appendChild(self.el)\n    self.elPos = self.el.getBoundingClientRect()\n    if(self.direction === 'b2t') {\n      self.width = self.elPos.height\n      self.height = self.elPos.width\n    } else {\n      self.width = self.elPos.width\n      self.height = self.elPos.height\n    }\n    if(self.moveV) {\n      let containerPos = self.container.getBoundingClientRect()\n      self.duration = (containerPos.width + self.width) / self.moveV * 1000\n    }\n    if (self.danmu.config.mouseControl) {\n      self.el.addEventListener('mouseover', self.mouseoverFun.bind(self))\n    } \n  }\n  mouseoverFun (event) {\n    let self = this\n    if ((self.danmu.mouseControl && self.danmu.config.mouseControlPause) || self.status === 'waiting' || self.status === 'end') {\n      return\n    } \n    self.danmu.emit('bullet_hover', {\n      bullet: self,\n      event: event\n    })\n  }\n  detach () {\n    let self = this\n    if(self.container && self.el) {\n      self.domObj.unuse(self.el)\n    }\n    self.danmu.off('changeDirection', direction => {\n      self.direction = direction\n    })\n  }\n  topInit () {\n    if(this.direction === 'b2t') {\n      let containerPos = this.container.getBoundingClientRect()\n      this.el.style.transformOrigin = 'left top'\n      this.el.style.transform = `translateX(-${this.top}px) translateY(${containerPos.height}px) translateZ(0px) rotate(90deg)`;\n      this.el.style.transition = `transform 0s linear 0s`\n    } else {\n      this.el.style.top = `${this.top}px`\n    }\n  }\n  pauseMove (containerPos, isFullscreen = false) {\n    // console.log('pauseMove')\n    let self = this\n    if(this.status === 'paused') {\n      return\n    }\n    if (self.status !== 'forcedPause') {\n      this.status = 'paused'\n    }\n    clearTimeout(self.removeTimer)\n    if (!this.el) {\n      return\n    }\n    this.el.style.willChange = 'auto'\n    if(this.mode === 'scroll') {\n      if(isFullscreen) {\n        let pastDuration = (new Date().getTime() - self.moveTime) / 1000\n        let pastS = pastDuration * this.moveV\n        let ratio = 0\n        let nowS = 0\n        // console.log('self.moveMoreS: ' + self.moveMoreS)\n        // console.log('pastS: ' + pastS)\n        if(self.moveMoreS - pastS >= 0) {\n          if(this.direction === 'b2t') {\n            ratio = (self.moveMoreS - pastS) / self.moveContainerHeight\n            nowS = ratio * containerPos.height\n          } else {\n            ratio = (self.moveMoreS - pastS) / self.moveContainerWidth\n            nowS = ratio * containerPos.width\n          }\n        } else {\n          nowS = self.moveMoreS - pastS\n        }\n        // console.log('nowS: ' + nowS)\n        if(this.direction === 'b2t') {\n          this.el.style.transform = `translateX(-${this.top}px) translateY(${nowS}px) translateZ(0px) rotate(90deg)`\n        } else {\n          this.el.style.left = `${nowS}px`\n        }\n      } else {\n        if(this.direction === 'b2t') {\n          this.el.style.transform = `translateX(-${this.top}px) translateY(${this.el.getBoundingClientRect().top - containerPos.top}px) translateZ(0px) rotate(90deg)`\n        } else {\n          this.el.style.left = `${this.el.getBoundingClientRect().left - containerPos.left}px`\n        }\n      }\n      if(this.direction === 'b2t') {\n        // this.el.style.transform = `translateX(-${this.top}px) translateY(${nowS}px) translateZ(0px) rotate(90deg)`\n        this.el.style.transition = 'transform 0s linear 0s'\n      } else {\n        this.el.style.transform = 'translateX(0px) translateY(0px) translateZ(0px)'\n        this.el.style.transition = 'transform 0s linear 0s'\n      }\n    } else {\n      if(!this.pastDuration || !this.startTime) {\n        this.pastDuration = 1\n      } else {\n        this.pastDuration = this.pastDuration + new Date().getTime() - this.startTime\n      }\n    }\n  }\n  startMove (containerPos, force) {\n    let self = this\n    if (!self.hasMove) {\n      self.danmu.emit('bullet_start', self)\n      self.hasMove = true\n    }\n    if (self.status === 'forcedPause' && !force) {\n      return\n    }\n    if (!this.el) return\n    if(this.status === 'start') return\n    this.status = 'start'\n    this.el.style.willChange = 'transform'\n    function func () {\n      if (self.el) {\n        if(self.mode === 'scroll') {\n          let containerPos_ = self.danmu.container.getBoundingClientRect()\n          let bulletPos = self.el.getBoundingClientRect()\n          if(self.direction === 'b2t') {\n            if (bulletPos && bulletPos.bottom <= containerPos_.top + 100) {\n              self.status = 'end'\n              self.remove()\n            } else {\n              self.pauseMove(containerPos_)\n              if (self.danmu.bulletBtn.main.status !== 'paused') {\n                self.startMove(containerPos_)\n              }\n            }\n          } else {\n            if (bulletPos && bulletPos.right <= containerPos_.left + 100) {\n              self.status = 'end'\n              self.remove()\n            } else {\n              self.pauseMove(containerPos_)\n              if (self.danmu.bulletBtn.main.status !== 'paused') {\n                self.startMove(containerPos_)\n              }\n            }\n          }\n        } else {\n          self.status = 'end'\n          self.remove()\n        }\n      }\n    }\n    if(this.mode === 'scroll') {\n      if(this.direction === 'b2t') {\n        this.moveV = (containerPos.height + this.height) / this.duration * 1000\n        let leftDuration = (self.el.getBoundingClientRect().bottom - containerPos.top) / this.moveV\n        this.el.style.transition = `transform ${leftDuration}s linear 0s`\n        setTimeout(function () {\n          if (self.el) {\n            self.el.style.transform = `translateX(-${self.top}px) translateY(-${self.height}px) translateZ(0px) rotate(90deg)`\n            self.moveTime = new Date().getTime()\n            self.moveMoreS = self.el.getBoundingClientRect().top - containerPos.top\n            self.moveContainerHeight = containerPos.height\n            self.removeTimer = setTimeout(func, leftDuration * 1000)\n          }\n        }, 20)\n      } else {\n        this.moveV = (containerPos.width + this.width) / this.duration * 1000\n        let leftDuration = (self.el.getBoundingClientRect().right - containerPos.left) / this.moveV\n        this.el.style.transition = `transform ${leftDuration}s linear 0s`\n        setTimeout(function () {\n          if (self.el) {\n            self.el.style.transform = `translateX(-${self.el.getBoundingClientRect().right - containerPos.left}px) translateY(0px) translateZ(0px)`\n            self.moveTime = new Date().getTime()\n            self.moveMoreS = self.el.getBoundingClientRect().left - containerPos.left\n            self.moveContainerWidth = containerPos.width\n            self.removeTimer = setTimeout(func, leftDuration * 1000)\n          }\n        }, 20)\n      }\n    } else {\n      // this.el.style.width = `${this.width}px`\n      // this.el.style.height = `${this.height}px`\n      this.el.style.left = '50%'\n      this.el.style.margin = `0 0 0 -${this.width/2}px`\n      if(!this.pastDuration) {\n        this.pastDuration = 1\n      }\n      let leftDuration = this.duration >= this.pastDuration ? this.duration - this.pastDuration : 0\n      this.removeTimer = setTimeout(func, leftDuration)\n      this.startTime = new Date().getTime()\n    }\n  }\n  remove () {\n    // console.log('remove')\n    let self = this\n    if (this.removeTimer) {\n      clearTimeout(this.removeTimer)\n    }\n    if (self.el && self.el.parentNode) {\n      self.el.style.willChange = 'auto'\n      this.danmu.off('changeDirection', direction => {\n        self.direction = direction\n      })\n      // self.el.removeEventListener('mouseover', self.mouseoverFun.bind(self))\n      this.domObj.unuse(self.el)\n      let parent = self.el.parentNode\n      parent.removeChild(self.el)\n      self.el = null\n      self.danmu.emit('bullet_remove', {\n        bullet: self\n      })\n    }\n  }\n  setFontSize (size) {\n    if (this.el) {\n      this.el.style[ 'fontSize' ] = size\n    }\n  }\n  setLikeDom (el, style) {\n    if (el) {\n      Object.keys(style).forEach(function (key) {\n        el.style[key] = style[key]\n      })\n      let likeClass = 'danmu-like'\n      el.className = likeClass\n      if (this.el) {\n        let children = this.el.querySelector('.' + likeClass)\n        if (children) {\n          this.el.removeChild(children)\n        }\n        this.el.innerHTML = `${this.el.innerHTML}${el.outerHTML}`\n      }\n    }\n    return el\n  }\n}\n\nexport default Bullet\n","\nvar content = require(\"!!../../node_modules/css-loader/index.js??ref--5-1!../../node_modules/postcss-loader/lib/index.js!../../node_modules/sass-loader/dist/cjs.js!./index.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js??ref--5-1!../../node_modules/postcss-loader/lib/index.js!../../node_modules/sass-loader/dist/cjs.js!./index.scss\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js??ref--5-1!../../node_modules/postcss-loader/lib/index.js!../../node_modules/sass-loader/dist/cjs.js!./index.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".danmu{overflow:hidden;-webkit-user-select:none;-moz-user-select:none;user-select:none;-ms-user-select:none}.danmu>*{position:absolute;white-space:nowrap}.danmu-switch{width:32px;height:20px;border-radius:100px;background-color:#ccc;-webkit-box-sizing:border-box;box-sizing:border-box;outline:none;cursor:pointer;position:relative;text-align:center;margin:10px auto}.danmu-switch.danmu-switch-active{padding-left:12px;background-color:#f85959}.danmu-switch span.txt{width:20px;height:20px;line-height:20px;text-align:center;display:block;border-radius:100px;background-color:#ffffff;-webkit-box-shadow:-2px 0 0 0 rgba(0, 0, 0, .04);box-shadow:-2px 0 0 0 rgba(0, 0, 0, .04);font-family:PingFangSC;font-size:10px;font-weight:500;color:#f44336}\\n\", \"\"]);\n\n// exports\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target) {\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertInto + \" \" + options.insertAt.before);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n"],"sourceRoot":""}